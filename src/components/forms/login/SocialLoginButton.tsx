
import React from 'react';
import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';

interface SocialLoginButtonProps {
  provider?: 'google' | 'facebook';
  className?: string;
  onClose?: () => void;
}

const SocialLoginButton = ({ provider = 'google', className, onClose }: SocialLoginButtonProps) => {
  const { toast } = useToast();
  
  const handleGoogleLogin = () => {
    console.log('üîÑ [LOGIN] Redirection vers l\'authentification Google');
    
    // Close modal if it exists
    if (onClose) {
      onClose();
    }
    
    // URL du backend pour l'authentification Google
    const backendUrl = import.meta.env.VITE_API_URL 
      ? `${import.meta.env.VITE_API_URL}/api/auth/google`
      : 'http://localhost:3000/api/auth/google';
    
    console.log('üîç [LOGIN] Redirection vers:', backendUrl);
    
    // Rediriger l'utilisateur vers l'URL d'authentification Google du backend
    window.location.href = backendUrl;
  };
  
  const handleLogin = () => {
    if (provider === 'google') {
      handleGoogleLogin();
    } else {
      // Pour l'instant, Facebook n'est pas impl√©ment√©
      toast({
        title: "Fonctionnalit√© non disponible",
        description: "La connexion avec Facebook n'est pas encore disponible.",
        variant: "destructive"
      });
    }
  };

  const providerName = provider === 'google' ? 'Google' : 'Facebook';
  const iconPath = provider === 'google' 
    ? 'M16.318 13.714v2.572h4.236c-.17 1.096-1.274 3.21-4.236 3.21-2.55 0-4.63-2.104-4.63-4.705 0-2.6 2.08-4.705 4.63-4.705 1.45 0 2.424.613 2.98 1.143l2.03-1.96C19.985 7.904 18.32 7 16.318 7c-4.014 0-7.272 3.267-7.272 7.29 0 4.024 3.258 7.29 7.272 7.29 4.198 0 6.987-2.958 6.987-7.107 0-.48-.053-.85-.115-1.213h-6.872v.01h.002z'
    : 'M20.292 7.67a.5.5 0 0 0-.482-.127c-.046.012-.09.027-.134.045-.42.15-.83.337-1.23.544-.404.212-.784.437-1.145.673a.232.232 0 0 0-.068.303c.263.433.497.883.698 1.343.113.258.22.52.318.787.262.71.46 1.44.587 2.184.125.741.167 1.49.126 2.24-.04.75-.18 1.49-.416 2.202-.232.71-.557 1.39-.966 2.017-.158.243-.332.474-.518.693-.184.222-.38.432-.587.629-.2.192-.413.37-.633.535-.216.161-.44.31-.672.443-.456.266-.937.48-1.436.634-.497.156-1.01.25-1.528.28-.51.032-1.02 0-1.522-.094-.49-.09-.967-.24-1.426-.437-.443-.19-.867-.426-1.265-.698-.39-.266-.756-.561-1.095-.883-.338-.32-.65-.664-.93-1.03-.278-.365-.526-.75-.74-1.152-.212-.4-.39-.82-.532-1.25-.14-.43-.24-.87-.308-1.32-.13-.93-.13-1.873 0-2.803.068-.449.168-.89.308-1.32.11-.4.262-.789.447-1.168.092-.19.192-.373.3-.551.106-.177.22-.345.342-.508.12-.162.248-.316.385-.462.135-.146.28-.282.43-.409.387-.322.804-.595 1.244-.813.22-.108.443-.205.672-.29.23-.085.462-.16.697-.22.487-.12.986-.182 1.487-.184.5-.002 1 .06 1.483.19.483.132.95.319 1.394.558.45.24.87.532 1.258.867.387.335.745.71 1.07 1.113.322.403.613.83.867 1.275.251.443.465.905.64 1.38.08.215.15.435.21.658.057.225.104.452.14.684.077.467.128.973.022 1.44-.106.468-.099.995-.465 1.313-.367.318-.848.412-1.318.43-.47.02-.95-.03-1.439-.123-.244-.046-.488-.102-.732-.165-.244-.064-.485-.138-.726-.22-.485-.164-.965-.352-1.44-.556-.476-.203-.946-.423-1.41-.66-.917-.47-1.82-.974-2.713-1.497-.894-.522-1.776-1.064-2.65-1.621-.874-.557-1.74-1.13-2.61-1.706-.848-.578-1.7-1.156-2.565-1.716-.59-.382-1.174-.897-1.548-1.529-.185-.315-.29-.66-.318-1.012-.028-.351.026-.703.157-1.035.134-.343.354-.65.627-.907.28-.263.61-.474.967-.618.725-.289 1.536-.286 2.318-.275.39.006.78.025 1.17.059.389.034.776.084 1.16.148.77.128 1.527.311 2.271.55.746.24 1.477.534 2.18.898.703.365 1.38.8 2.011 1.311.315.258.616.533.897.83.284.295.545.616.78.959.233.342.439.702.607 1.086.166.384.3.784.391 1.197.074.33.114.668.12 1.008.007.341-.02.682-.077 1.013-.062.34-.153.67-.272.986-.119.317-.265.62-.432.906-.335.57-.746 1.09-1.157 1.61-1.657 2.09-3.35 4.152-5.01 6.234-.833 1.04-1.662 2.084-2.49 3.134-.828 1.048-1.652 2.1-2.48 3.154-.206.262-.413.523-.618.787-.205.264-.408.529-.612.795-.408.533-.816 1.065-1.225 1.597l-.308.406c-.103.136-.206.271-.309.407-.204.271-.409.542-.615.812-.204.273-.413.541-.598.828-.184.283-.347.585-.485.9-.138.317-.249.647-.328.985-.081.338-.126.685-.134 1.033-.007.348.024.697.093 1.042.07.345.176.68.32.994.146.312.324.605.532.868.208.264.443.5.703.701.26.201.544.368.844.493.301.125.615.21.935.255.32.044.65.049.973.016.324-.033.642-.104.952-.208.309-.104.606-.245.888-.414.292-.177.567-.382.824-.61.127-.114.244-.237.361-.36.119-.125.229-.257.333-.394.119-.155.229-.317.333-.484.106-.168.207-.34.305-.514.098-.176.193-.353.29-.529l.159-.28c.054-.093.11-.185.169-.273.118-.177.243-.348.373-.516.18-.226.374-.442.577-.646.203-.205.416-.397.637-.577.223-.18.455-.348.697-.5.242-.153.493-.29.752-.409.256-.119.52-.22.794-.3.271-.08.55-.141.836-.178.35-.046.71-.058 1.062-.036.35.022.7.08 1.043.17.344.091.68.215 1.006.37.321.15.63.332.926.541.157.113.31.231.465.35.154.12.309.241.462.365.308.248.613.5.914.754.3.252.598.51.886.771.574.522 1.112 1.078 1.611 1.663.252.293.494.594.727.9.232.306.454.618.665.936.21.318.41.641.598.973.178.322.35.653.51.992.16.338.312.683.455 1.032.142.35.276.702.4 1.06.124.358.238.72.343 1.086.105.366.2.736.288 1.108.086.367.166.74.24 1.122l.104.57c.062.376.122.752.18 1.13.058.378.114.757.166 1.138.104.76.194 1.522.27 2.285.039.382.072.764.1 1.148.027.383.049.765.064 1.147.031.766.039 1.533.024 2.299-.006.393-.02.786-.04 1.178-.02.386-.045.773-.076 1.16-.031.388-.067.776-.11 1.162-.041.385-.09.77-.143 1.152-.088.641-.19 1.28-.306 1.917-.058.318-.118.636-.183.952-.063.316-.127.63-.197.946-.14.631-.284 1.26-.448 1.885-.8.314-.167.628-.257.94-.09.31-.181.622-.277.932-.19.62-.394 1.234-.613 1.845-.108.31-.222.616-.341.92-.119.304-.241.602-.366.902-.127.3-.255.597-.387.889-.132.291-.266.582-.403.871-.14.287-.279.572-.421.853-.37.742-.763 1.47-1.176 2.184-.209.357-.422.712-.64 1.061-.216.353-.439.7-.663 1.042-.449.686-.908 1.363-1.377 2.032l-.708 1.004-.715.99c-.477.66-.964 1.312-1.461 1.96-.248.323-.498.645-.75.965-.254.32-.505.637-.76.952-.257.317-.517.626-.776.936-.259.31-.517.616-.778.918-.292.341-.586.678-.882 1.014-.296.337-.591.669-.891.997-.299.328-.604.651-.909.971-.307.321-.616.638-.928.953-.31.314-.625.623-.94.931-.315.309-.633.612-.951.912-.319.3-.64.597-.963.891-.324.294-.65.583-.977.868-.327.286-.656.566-.992.844-.334.277-.666.549-1.007.817l-.514.405-.515.395c-.343.262-.69.52-1.038.775-.348.256-.698.507-1.052.753-.353.247-.708.49-1.067.727-.358.238-.718.47-1.082.698-.363.227-.727.45-1.094.669-.366.219-.735.432-1.103.645-.305.177-.61.352-.915.523-.305.17-.613.338-.921.504-.31.165-.621.33-.932.49l-.47.24-.47.235'
  ;

  return (
    <Button
      onClick={handleLogin}
      variant="outline"
      className={`flex items-center w-full font-medium ${className}`}
    >
      <svg 
        width="20" 
        height="20" 
        fill="currentColor" 
        className="mr-2"
        viewBox="0 0 24 24"
      >
        <path d={iconPath} />
      </svg>
      Continuer avec {providerName}
    </Button>
  );
};

export default SocialLoginButton;
